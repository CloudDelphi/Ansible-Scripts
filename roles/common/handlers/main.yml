# 'service: name=... state=started' tasks should NOT run if there is a
# corresponding state=restarted handler.  (Register the task notifying
# the handler, and add a conditional.)
---
- name: Refresh hostname
  service: name=hostname.sh state=restarted

- name: apt-get update
  apt: update_cache=yes

- name: Reload samhain
  service: name=samhain state=reloaded

- name: Update rkhunter's data file
  command: /usr/bin/rkhunter --propupd

- name: Restart fail2ban
  service: name=fail2ban state=restarted

- name: Reload networking
  # /etc/init.d/networking doesn't answer the status command; but since
  # it should be "up" whenever ansible has access to the machine, we use
  # pattern=init as a dummy assumption.
  service: name=networking pattern=init state=reloaded

- name: Restart rsyslog
  service: name=rsyslog state=restarted

- name: Restart ntp
  service: name=ntp state=restarted

- name: Restart Postfix
  service: name=postfix state=restarted

- name: Reload Postfix
  service: name=postfix state=reloaded

- name: Update certificate
  command: update-ca-certificates
