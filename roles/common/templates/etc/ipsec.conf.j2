# {{ ansible_managed }}
# Do NOT edit this file directly!

config setup
    plutostart = no

# Add connections here.

conn %default
    keyexchange  = ikev2
    ikelifetime  = 1h
    keylife      = 15m
    rekeymargin  = 3m
    keyingtries  = 1
    esp          = aes128gcm16-ecp256!
    ike          = aes128gcm16-aesxcbc-ecp256!
    # TODO: test DynDNS
    mobike       = no
    leftauth     = pubkey
    left         = %defaultroute
    leftcert     = {{ inventory_hostname }}.pem
    leftfirewall = yes
    rightauth    = pubkey
    auto         = start
{% for host in groups.all | difference([inventory_hostname]) | sort %}

conn {{ host }}
    right     = {{ hostvars[host]['inventory_hostname'] }}
    rightcert = {{ hostvars[host]['inventory_hostname'] }}.pem
{%- endfor %}
