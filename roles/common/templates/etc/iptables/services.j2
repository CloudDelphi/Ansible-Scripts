# {{ ansible_managed }}
# Do NOT edit this file directly!
#
# direction              protocol     destination port            source port
# (in|out|inout)[46]?    (tcp|udp|..) (port|port:port|port,port)  (port|port:port|port,port)

out     tcp     80,443                                  # HTTP/HTTPS
out     udp     53                                      # DNS
out     udp     67                                      # DHCP

{% if 'NTP-master' in group_names %}
out     udp     123      123                            # NTP
{% endif %}

in      tcp     {{ ansible_ssh_port|default('22') }}    # SSH
{% if 'LDAP-provider' in group_names %}
in      tcp     636                                     # LDAPS
{% elif 'MX' in group_names or  'lists' in group_name %}
out     tcp     636                                     # LDAPS
{% endif %}
{% if 'MX' in group_names %}
in      tcp     25                                      # SMTP
out     tcp     {{ postfix_instance.IMAP.port }}
out     tcp     {{ postfix_instance.lists.port }}
{% endif %}
{% if 'out' in group_names %}
in      tcp     {{ postfix_instance.out.port }}
out     tcp     25                                      # SMTP
{% else %}
out     tcp     {{ postfix_instance.out.port }}
{% endif %}
{% if 'IMAP' in group_names %}
in      tcp     993                                     # IMAPS
in      tcp     4190                                    # ManageSieve
{% endif %}
{% if 'MDA' in group_names %}
in      tcp     {{ postfix_instance.IMAP.port }}
{% endif %}
{% if 'MSA' in group_names %}
in      tcp     587                                     # SMTP-AUTH
{% endif %}
{% if 'webmail' in group_names %}
in     tcp      80,443                                  # HTTP/HTTPS
out    tcp      993                                     # IMAP
out    tcp      4190
{% endif %}
